<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Piss Latin</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      color: #000;
      padding: 30px;
      transition: background 0.2s, color 0.2s;
    }

    h1 {
      margin-bottom: 10px;
    }

    textarea {
      width: 100%;
      height: 120px;
      margin-top: 10px;
      font-size: 16px;
      padding: 10px;
    }

    input {
      margin-top: 10px;
      width: 60px;
      padding: 5px;
    }

    button {
      margin-top: 15px;
      margin-right: 10px;
      padding: 10px 15px;
      font-size: 14px;
      cursor: pointer;
    }

    /* Dark mode */
    .dark {
      background: #121212;
      color: #e0e0e0;
    }

    .dark textarea,
    .dark input {
      background: #1e1e1e;
      color: #e0e0e0;
      border: 1px solid #444;
    }

    .dark button {
      background: #2a2a2a;
      color: #e0e0e0;
      border: 1px solid #444;
    }

    /* Theme toggle button */
    .theme-toggle {
      position: fixed;
      top: 12px;
      right: 12px;
      font-size: 18px;
      padding: 6px 8px;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<button class="theme-toggle" onclick="toggleDarkMode()" id="themeBtn">‚òÄÔ∏è</button>

<h1>Piss Latin</h1>

<label>Shift Value:</label>
<input type="number" id="shift" value="3">

<br>

<button onclick="pasteInput()">Paste</button>

<textarea id="inputText" placeholder="Enter text here..."></textarea>

<br>

<button onclick="encode()">Encode</button>
<button onclick="decode()">Decode</button>

<br>

<button onclick="copyOutput()">Copy</button>

<textarea id="outputText" placeholder="Output..."></textarea>

<script>
  const themeBtn = document.getElementById("themeBtn");

  // Load saved theme (unchanged)
  if (localStorage.getItem("darkMode") === "true") {
    document.body.classList.add("dark");
    themeBtn.textContent = "üåô";
  }

  function toggleDarkMode() {
    document.body.classList.toggle("dark");
    const isDark = document.body.classList.contains("dark");
    localStorage.setItem("darkMode", isDark);
    themeBtn.textContent = isDark ? "üåô" : "‚òÄÔ∏è";
  }

  function caesarShift(text, shift) {
    return text.split("").map(char => {
      if (/[a-z]/i.test(char)) {
        const code = char.charCodeAt(0);
        const base = code >= 65 && code <= 90 ? 65 : 97;
        return String.fromCharCode(((code - base + shift + 26) % 26) + base);
      }
      return char;
    }).join("");
  }

  function toCustomLatin(word) {
    if (word.length < 2) return word;
    return word.slice(1) + word[0] + "ay";
  }

  function fromCustomLatin(word) {
    if (!word.endsWith("ay") || word.length < 4) return word;
    const core = word.slice(0, -2);
    return core.slice(-1) + core.slice(0, -1);
  }

  function encode() {
    const shift = parseInt(document.getElementById("shift").value);
    let text = document.getElementById("inputText").value;

    text = caesarShift(text, shift);
    text = text.split(" ").map(toCustomLatin).join(" ");

    document.getElementById("outputText").value = text.toLowerCase();
  }

  function decode() {
    const shift = parseInt(document.getElementById("shift").value);
    let text = document.getElementById("inputText").value;

    text = text.split(" ").map(fromCustomLatin).join(" ");
    text = caesarShift(text, -shift);

    document.getElementById("outputText").value = text.toLowerCase();
  }

  async function pasteInput() {
    try {
      const text = await navigator.clipboard.readText();
      document.getElementById("inputText").value = text;
    } catch {
      alert("Clipboard access denied");
    }
  }

  async function copyOutput() {
    const text = document.getElementById("outputText").value;
    if (!text) return;
    try {
      await navigator.clipboard.writeText(text);
    } catch {
      alert("Clipboard access denied");
    }
  }
</script>

</body>
</html>
